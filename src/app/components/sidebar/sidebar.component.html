<aside class="sidebar">
  <!-- Source Stats -->
  <section class="sidebar-section">
    <h3 class="section-title">ğŸ“Š {{ i18n.t.grumble.sources }}</h3>
    <div class="source-stats">
      <div class="stat-item" [class.active]="isSourceEnabled('twitter-search')" (click)="toggleSource('twitter-search')">
        <span class="stat-icon">ğ•</span>
        <span class="stat-label">{{ i18n.t.grumble.twitter }}</span>
        <span class="stat-count">{{ stats().bySource.twitter }}</span>
      </div>
      <div class="stat-item" [class.active]="isSourceEnabled('github-issue')" (click)="toggleSource('github-issue')">
        <span class="stat-icon">ğŸ›</span>
        <span class="stat-label">{{ i18n.t.grumble.issues }}</span>
        <span class="stat-count">{{ stats().bySource.githubIssues }}</span>
      </div>
      <div class="stat-item" [class.active]="isSourceEnabled('github-discussion')"
        (click)="toggleSource('github-discussion')">
        <span class="stat-icon">ğŸ’¬</span>
        <span class="stat-label">{{ i18n.t.grumble.discussions }}</span>
        <span class="stat-count">{{ stats().bySource.githubDiscussions }}</span>
      </div>
      <div class="stat-item" [class.active]="isSourceEnabled('discourse')" (click)="toggleSource('discourse')">
        <span class="stat-icon">ğŸ—£ï¸</span>
        <span class="stat-label">{{ i18n.t.grumble.forum }}</span>
        <span class="stat-count">{{ stats().bySource.discourse }}</span>
      </div>
    </div>
  </section>

  <!-- Keywords Section -->
  <section class="sidebar-section">
    <div class="section-header">
      <h3 class="section-title">ğŸ” {{ i18n.t.grumble.keywords }}</h3>
      <button class="btn-add" (click)="showAddKeyword.set(true)" title="Add keyword">
        <span>+</span>
      </button>
    </div>

    @if (showAddKeyword()) {
    <div class="add-form animate-fadeIn">
      <input type="text" class="input" placeholder="e.g. gemini api error" [(ngModel)]="newKeyword" />
      <div class="form-actions">
        <button class="btn btn-secondary" (click)="showAddKeyword.set(false)">Cancel</button>
        <button class="btn btn-primary" (click)="addKeyword()">Add</button>
      </div>
    </div>
    }

    <div class="items-list">
      @for (keyword of twitterService.keywords(); track keyword.id) {
      <div class="list-item" [class.disabled]="!keyword.enabled">
        <span class="item-icon">ğŸ·ï¸</span>
        <span class="item-name">{{ keyword.term }}</span>
        <button class="item-toggle" [class.active]="keyword.enabled" (click)="twitterService.toggleKeyword(keyword.id)">
          <span class="toggle-dot"></span>
        </button>
        <button class="btn-delete" (click)="twitterService.removeKeyword(keyword.id)">Ã—</button>
      </div>
      }
    </div>
    </section>
    
    <!-- GitHub Repos Section -->
    <section class="sidebar-section">
      <div class="section-header">
        <h3 class="section-title">ğŸ™ {{ i18n.t.grumble.githubRepos }}</h3>
      </div>
    
      <div class="items-list">
        @for (repo of githubService.repos(); track repo.id) {
        <div class="list-item" [class.disabled]="!repo.enabled">
          <span class="item-icon">ğŸ“¦</span>
          <span class="item-name">{{ repo.repo }}</span>
          <button class="item-toggle" [class.active]="repo.enabled" (click)="githubService.toggleRepo(repo.id)">
          <span class="toggle-dot"></span>
        </button>
      </div>
      }</div>
      </section>
      
      <!-- Feedback Groups Section -->
      @if (feedbackService.groups().length > 0) {
      <section class="sidebar-section">
        <div class="section-header">
          <h3 class="section-title">ğŸ“ {{ i18n.t.grumble.feedbackGroups }}</h3>
          @if (selectedGroup()) {
          <button class="btn-clear" (click)="clearGroupFilter()">{{ i18n.t.grumble.clear }}</button>
          }
        </div>
      
        <div class="groups-list">
          @for (group of feedbackService.groups(); track group.id) {
          <div class="group-item" [class.active]="selectedGroup() === group.id" (click)="filterByGroup(group.id)">
            <div class="group-header">
              <span class="group-sentiment">{{ getSentimentIcon(group.sentiment) }}</span>
              <span class="group-theme">{{ group.theme }}</span>
            </div>
            <div class="group-meta">
              <span class="group-count">{{ group.itemCount }} {{ i18n.t.grumble.items }}</span>
              <span class="group-category">{{ group.category }}</span>
            </div>
      </div>
      }
    </div>
  </section>
  }

  <!-- Sync Button -->
  <button class="btn btn-primary btn-full sync-button" (click)="onSync()"
    [disabled]="feedbackService.isLoading() || authService.isReporter()"
    [title]="authService.isReporter() ? 'Reporters cannot sync sources' : ''">
    @if (feedbackService.isLoading()) {
    <span class="spinner"></span>
    <span>{{ i18n.t.grumble.syncing }}</span>
    } @else if (authService.isReporter()) {
    <span class="sync-icon">ğŸ”’</span>
    <span>{{ i18n.t.grumble.syncAllSources }}</span>
    } @else {
    <span class="sync-icon">ğŸ”„</span>
    <span>{{ i18n.t.grumble.syncAllSources }}</span>
    }
  </button>

  <!-- How it Works -->
  <section class="how-it-works">
    <h4 class="how-title">{{ i18n.t.grumble.howItWorks }}</h4>
    <ul class="how-list">
      <li>{{ i18n.t.grumble.howStep1 }}</li>
      <li>{{ i18n.t.grumble.howStep2 }}</li>
      <li>{{ i18n.t.grumble.howStep3 }}</li>
    </ul>
  </section>
</aside>